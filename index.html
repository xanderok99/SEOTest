<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Backlink Comparison Tool</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f8faff;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #004c99;
      color: white;
      padding: 15px 30px;
      text-align: center;
      font-size: 24px;
    }

    .container {
      padding: 30px;
      max-width: 1200px;
      margin: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      vertical-align: top;
    }

    th {
      background-color: #e6f0ff;
    }

    textarea {
      width: 100%;
      height: 150px;
      resize: vertical;
    }

    .filters {
      margin-bottom: 20px;
    }

    .filters label {
      margin-right: 20px;
    }

    button {
      background-color: #0073e6;
      color: white;
      padding: 10px 20px;
      border: none;
      cursor: pointer;
      border-radius: 5px;
    }

    button:hover {
      background-color: #005bb5;
    }

    footer {
      background-color: #004c99;
      color: white;
      text-align: center;
      padding: 10px;
    }

    .result-table {
      margin-top: 30px;
    }

    .result-table table {
      border: 1px solid #ccc;
    }

    .result-table th {
      background: #d9eaff;
    }

    input[type="file"] {
      margin: 10px 0;
    }
  </style>
</head>
<body>

  <header>Backlink Comparison Tool</header>

  <div class="container">
    <h2>Manual Backlink Input</h2>
    <table id="input-table">
      <thead>
        <tr>
          <th>Website 1</th>
          <th>Website 2</th>
          <th>Website 3</th>
          <!-- Add more websites as needed -->
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><textarea id="site1"></textarea></td>
          <td><textarea id="site2"></textarea></td>
          <td><textarea id="site3"></textarea></td>
        </tr>
      </tbody>
    </table>

    <h2>Or Upload CSV Files (one per brand)</h2>
    <input type="file" id="csvUpload" multiple accept=".csv"><br><br>

    <div class="filters">
      <label><input type="radio" name="filter" value="similar" checked> Show Similar Domains</label>
      <label><input type="radio" name="filter" value="unsimilar"> Show Unsimilar Domains Between Brands</label>
      <label><input type="radio" name="filter" value="brand-unique"> Unsimilar Domains per Brand</label>
    </div>

    <button onclick="compareDomains()">Compare</button>

    <div class="result-table" id="result"></div>
  </div>

  <footer>© 2025 Backlink Checker | Built for Fast Brand Comparison</footer>

  <script>
    function parseTextarea(id) {
      return document.getElementById(id).value
        .split(/\n|,/)
        .map(x => x.trim())
        .filter(x => x.length > 0);
    }

    function handleCSVUpload(callback) {
      const input = document.getElementById('csvUpload');
      const files = input.files;
      const readers = [];

      if (!files.length) {
        callback([]);
        return;
      }

      let results = [];
      let filesProcessed = 0;

      for (let i = 0; i < files.length; i++) {
        const reader = new FileReader();
        reader.onload = function (e) {
          const lines = e.target.result.split(/\r?\n/).map(x => x.trim()).filter(x => x);
          results.push(lines);
          filesProcessed++;
          if (filesProcessed === files.length) callback(results);
        };
        reader.readAsText(files[i]);
      }
    }

    function compareDomains() {
      handleCSVUpload((csvData) => {
        const brands = [
          parseTextarea('site1'),
          parseTextarea('site2'),
          parseTextarea('site3'),
          ...csvData
        ];

        const uniqueSets = brands.map(set =>
          new Set(set.map(url => new URL(url).hostname).filter(Boolean))
        );

        const allDomains = Array.from(new Set(uniqueSets.flatMap(set => [...set])));
        const mode = document.querySelector('input[name="filter"]:checked').value;

        let resultHTML = '<table><tr><th>Domain</th>';

        for (let i = 0; i < uniqueSets.length; i++) {
          resultHTML += `<th>Website ${i + 1}</th>`;
        }
        resultHTML += '</tr>';

        for (let domain of allDomains) {
          const presence = uniqueSets.map(set => set.has(domain));
          let show = false;

          if (mode === 'similar') {
            show = presence.every(v => v);
          } else if (mode === 'unsimilar') {
            const trueCount = presence.filter(Boolean).length;
            show = trueCount >= 1 && trueCount < uniqueSets.length;
          } else if (mode === 'brand-unique') {
            const trueCount = presence.filter(Boolean).length;
            show = trueCount === 1;
          }

          if (show) {
            resultHTML += `<tr><td>${domain}</td>`;
            presence.forEach(p => {
              resultHTML += `<td style="text-align:center;">${p ? '✔️' : ''}</td>`;
            });
            resultHTML += '</tr>';
          }
        }

        resultHTML += '</table>';
        document.getElementById('result').innerHTML = resultHTML;
      });
    }
  </script>

</body>
</html>
